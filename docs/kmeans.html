<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" class="no-js">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Chapter 2 K-means clustering | CamStats</title>
<meta name="author" content="Martin van Rongen and Matt Castle">
<meta name="description" content="2.1 Objectives  Objectives   2.2 Libraries and functions  tidyverse Library Description tidyverse A collection of R packages designed for data science broom Summarises key information about...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 2 K-means clustering | CamStats">
<meta property="og:type" content="book">
<meta property="og:description" content="2.1 Objectives  Objectives   2.2 Libraries and functions  tidyverse Library Description tidyverse A collection of R packages designed for data science broom Summarises key information about...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 2 K-means clustering | CamStats">
<meta name="twitter:description" content="2.1 Objectives  Objectives   2.2 Libraries and functions  tidyverse Library Description tidyverse A collection of R packages designed for data science broom Summarises key information about...">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Place favicon.ico & apple-touch-icon.png in the root of your domain and delete these references --><link rel="shortcut icon" href="favicon.ico">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<!-- CSS : implied media="all" --><link rel="stylesheet" href="stylesheets/full-stylesheet.css">
<link rel="stylesheet" href="stylesheets/styleguide.css">
<link rel="stylesheet" href="stylesheets/style.css">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="libs/panelset-0.2.6/panelset.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><script type="text/javascript" src="//use.typekit.com/hyb5bko.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script><script type="text/javascript">  document.documentElement.className += " js";</script>
</head>
<body class="campl-theme-2" data-spy="scroll" data-target="#toc">

<!--[if lt IE 7]>
<div class="lt-ie9 lt-ie8 lt-ie7">
<![endif]-->
<!--[if IE 7]>
<div class="lt-ie9 lt-ie8">
<![endif]-->
<!--[if IE 8]>
<div class="lt-ie9">
<![endif]-->

	<a href="#primary-nav" class="campl-skipTo">skip to primary navigation</a>
	<a href="#content" class="campl-skipTo">skip to content</a>

	<div class="campl-row campl-page-header campl-sub-section-page">
		<div class="campl-wrap clearfix">
			<div class="campl-column12">
				<div class="campl-content-container">
					<div class="campl-breadcrumb" id="breadcrumb">
						<ul class="campl-unstyled-list campl-horizontal-navigation clearfix">
<li class="first-child">
								<a href="https://bioinfotraining.bio.cam.ac.uk/" class="campl-home ir">Home</a>
							</li>
							<li>
								<a href="">Courses</a>
							</li>
							<li>
								<a href="">Training Materials</a>
							</li>
							<li>
								<a href="index.html">CamStats
							</a>
</li>
						</ul>
</div>
					<!--<p class="campl-page-title">Bioinformatics Training Materials</p>-->

					<!-- <p class="campl-mobile-parent"><a href=""><span class="campl-back-btn campl-menu-indicator"></span>Studying at Cambridge</a></p> -->
				</div>
			</div>
		</div>
	</div>

	<div class="campl-row campl-page-header">
		<div class="campl-wrap clearfix campl-local-navigation" id="local-nav">
			<div class="campl-local-navigation-container">
				<ul class="campl-unstyled-list">
<li><a href="https://training.cam.ac.uk/bioinformatics/search">Course schedule</a></li>
					<li>
<a href="#" class="campl-selected">Additional information</a>
						<ul class="campl-unstyled-list local-dropdown-menu">
<li><a href="#">Additional resources</a></li>
							<li><a href="https://bioinfotraining.bio.cam.ac.uk/about/findus">Where to find us?</a></li>
							<li><a href="#">Frequently asked questions</a></li>
						</ul>
</li>
					<li><a href="https://bioinfotraining.bio.cam.ac.uk/postgraduate">Further training</a></li>
				</ul>
</div>
		</div>



		<div class="campl-wrap clearfix campl-page-sub-title campl-recessed-sub-title">
			<div class="campl-column12">
				<div class="campl-content-container">
					<p class="campl-sub-title">CamStats</p>
				</div>
			</div>
		</div>
	</div>


		<div class="campl-row campl-content campl-recessed-content">
			<div class="campl-wrap clearfix">
				<div class="campl-column9  campl-main-content" id="content">
					<div class="campl-content-container">
						<div>
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <br><button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Overview</a></li>
<li><a class="active" href="kmeans.html"><span class="header-section-number">2</span> K-means clustering</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="kmeans" class="section level1" number="2">
<h1>
<span class="header-section-number">2</span> K-means clustering<a class="anchor" aria-label="anchor" href="#kmeans"><i class="fas fa-link"></i></a>
</h1>
<div id="objectives" class="section level2" number="2.1">
<h2>
<span class="header-section-number">2.1</span> Objectives<a class="anchor" aria-label="anchor" href="#objectives"><i class="fas fa-link"></i></a>
</h2>
<div class="objectives">
<p>Objectives</p>
</div>
</div>
<div id="libraries-and-functions" class="section level2" number="2.2">
<h2>
<span class="header-section-number">2.2</span> Libraries and functions<a class="anchor" aria-label="anchor" href="#libraries-and-functions"><i class="fas fa-link"></i></a>
</h2>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">tidyverse</span></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="left">Library</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>tidyverse</code></td>
<td align="left">A collection of R packages designed for data science</td>
</tr>
<tr class="even">
<td align="left"><code>broom</code></td>
<td align="left">Summarises key information about statistical objects in tidy tibbles</td>
</tr>
<tr class="odd">
<td align="left"><code>modeldata</code></td>
<td align="left">Contains data sets used in documentation and testing for tidymodels packages.</td>
</tr>
</tbody>
</table></div>
</div>
<div class="panel">
<p><span class="panel-name">base R</span></p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="left">Library</th>
<th align="left">Description</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left"><code>modeldata</code></td>
<td align="left">Contains data sets used in documentation and testing for tidymodels packages.</td>
</tr></tbody>
</table></div>
</div>
</div>
</div>
<div id="workflow" class="section level2" number="2.3">
<h2>
<span class="header-section-number">2.3</span> Workflow<a class="anchor" aria-label="anchor" href="#workflow"><i class="fas fa-link"></i></a>
</h2>
<p>K-means clustering is an iterative process. It follows the following steps:</p>
<ol style="list-style-type: decimal">
<li>Select the number of clusters to identify (e.g. K = 3)</li>
<li>Create centroids</li>
<li>Place centroids randomly in your data</li>
<li>Assign each data point to the closest centroid</li>
<li>Calculate the centroid of each new cluster</li>
<li>Repeat steps 4-5 until the clusters do not change</li>
</ol>
</div>
<div id="data" class="section level2" number="2.4">
<h2>
<span class="header-section-number">2.4</span> Data<a class="anchor" aria-label="anchor" href="#data"><i class="fas fa-link"></i></a>
</h2>
<p>First we need some data! To liven things up a bit, we’ll be using data from the <code>modeldata</code> package. This package has a whole bunch of interesting datasets for us to look at. I’ll be using the <code>penguins</code> dataset to illustrate the K-means clustering, but I’ve highlighted some other data sets that you can try this on yourself.</p>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">penguins</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># attach the data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"penguins"</span><span class="op">)</span></code></pre></div>
</div>
<div class="panel">
<p><span class="panel-name">Alzheimer’s</span></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># attach the data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"ad_data"</span><span class="op">)</span></code></pre></div>
<<<<<<< HEAD
</div>
</div>
</div>
=======
</div>
</div>
</div>
>>>>>>> b22398e385062f343f1bcb4b717c505a984a4490
<div id="visualise-the-data" class="section level2" number="2.5">
<h2>
<span class="header-section-number">2.5</span> Visualise the data<a class="anchor" aria-label="anchor" href="#visualise-the-data"><i class="fas fa-link"></i></a>
</h2>
<p>First of all, let’s have a look at the data. It is always a good idea to get a sense of how your data.</p>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">tidyverse</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">penguins</span></code></pre></div>
<pre><code>## # A tibble: 344 × 7
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 334 more rows, and 1 more variable: sex &lt;fct&gt;</code></pre>
</div>
<div class="panel">
<p><span class="panel-name">base R</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   species island bill_length_mm bill_depth_mm flipper_length_… body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Torge…           39.1          18.7              181        3750 male 
## 2 Adelie  Torge…           39.5          17.4              186        3800 fema…
## 3 Adelie  Torge…           40.3          18                195        3250 fema…
## 4 Adelie  Torge…           NA            NA                 NA          NA &lt;NA&gt; 
## 5 Adelie  Torge…           36.7          19.3              193        3450 fema…
## 6 Adelie  Torge…           39.3          20.6              190        3650 male</code></pre>
</div>
</div>
<p>So we have different types of penguins, from different islands. Bill and flipper measurements were taken, and the penguins’ weight plus sex was recorded.</p>
<p>So let’s have a look at flipper length versus bill length, as an example.</p>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">tidyverse</span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">penguins</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>,
                     y <span class="op">=</span> <span class="va">bill_length_mm</span>,
                     colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="clustering-practical-kmeans_files/figure-html/unnamed-chunk-6-1.png" width="672"></div>
</div>
<div class="panel">
<p><span class="panel-name">base R</span></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<<<<<<< HEAD
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">flipper_length_mm</span>,  <span class="co"># scatter plot</span>
     <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span>,
     pch <span class="op">=</span> <span class="fl">20</span>,
     col <span class="op">=</span> <span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>      <span class="co"># colour by species</span>

=======
<code class="sourceCode R"><span class="co"># scatter plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">flipper_length_mm</span>,
     <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span>,
     pch <span class="op">=</span> <span class="fl">20</span>,
     col <span class="op">=</span> <span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>
>>>>>>> b22398e385062f343f1bcb4b717c505a984a4490

<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,             <span class="co"># legend</span>
       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span>,
       pch <span class="op">=</span> <span class="fl">20</span>,
       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="clustering-practical-kmeans_files/figure-html/unnamed-chunk-7-1.png" width="672"></div>
</div>
</div>
<p>We can already see that the data appear to cluster quite closely by species. A great example to illustrate K-means clustering (you’d almost think I chose the example on purpose!)</p>
</div>
<div id="clustering" class="section level2" number="2.6">
<h2>
<span class="header-section-number">2.6</span> Clustering<a class="anchor" aria-label="anchor" href="#clustering"><i class="fas fa-link"></i></a>
</h2>
<p>Next, we’ll do the actual clustering.</p>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">tidyverse</span>
To do the clustering, we’ll be using the <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> function. This function requires numeric data as its input.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">points</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op">%&gt;%</span> 
  <span class="fu">select</span><span class="op">(</span><span class="va">flipper_length_mm</span>,      <span class="co"># select data</span>
         <span class="va">bill_length_mm</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">drop_na</span><span class="op">(</span><span class="op">)</span>                      <span class="co"># remove missing values</span>

<span class="va">kclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">points</span>,         <span class="co"># perform k-means clustering</span>
                   centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>  <span class="co"># using 3 centers</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">kclust</span><span class="op">)</span>                  <span class="co"># summarise output</span></code></pre></div>
<pre><code>##              Length Class  Mode   
## cluster      342    -none- numeric
## centers        6    -none- numeric
## totss          1    -none- numeric
## withinss       3    -none- numeric
## tot.withinss   1    -none- numeric
## betweenss      1    -none- numeric
## size           3    -none- numeric
## iter           1    -none- numeric
## ifault         1    -none- numeric</code></pre>
<p>Note that the output is a list of vectors, with differing lengths. That’s because they contain different types of information:</p>
<ul>
<li>
<code>cluster</code> contains information about each point</li>
<li>
<code>centers</code>, <code>withinss</code>, and <code>size</code> contain information about each cluster</li>
<li>
<code>totss</code>, <code>tot.withinss</code>, <code>betweenss</code>, and <code>iter</code> contain information about the full clustering</li>
</ul>
</div>
<div class="panel">
<p><span class="panel-name">base R</span>
To do the clustering, we’ll be using the <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> function. This function requires numeric data as its input.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<<<<<<< HEAD
<code class="sourceCode R"><span class="va">points_r</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
    <span class="va">penguins</span><span class="op">$</span><span class="va">flipper_length_mm</span>,  <span class="co"># get numeric data</span>
    <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span> |&gt;  <span class="co"># use base R pipe!</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span>                      <span class="co"># remove missing data</span>

<span class="va">kclust_r</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">points_r</span>,               <span class="co"># perform k-means clustering</span>
         centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>            <span class="co"># using 3 centers</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">kclust_r</span><span class="op">)</span>                <span class="co"># summarise output</span></code></pre></div>
=======
<code class="sourceCode R"><span class="va">points_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
              <span class="va">penguins</span><span class="op">$</span><span class="va">flipper_length_mm</span>,  <span class="co"># get numeric data</span>
              <span class="va">penguins</span><span class="op">$</span><span class="va">bill_length_mm</span><span class="op">)</span> |&gt;  <span class="co"># use base R pipe!</span>
              <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span>                    <span class="co"># remove missing data</span>

<span class="va">kclust_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">points_r</span>,               <span class="co"># perform k-means clustering</span>
                   centers <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>            <span class="co"># using 3 centers</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">kclust_r</span><span class="op">)</span>                          <span class="co"># summarise output</span></code></pre></div>
>>>>>>> b22398e385062f343f1bcb4b717c505a984a4490
<pre><code>##              Length Class  Mode   
## cluster      342    -none- numeric
## centers        6    -none- numeric
## totss          1    -none- numeric
## withinss       3    -none- numeric
## tot.withinss   1    -none- numeric
## betweenss      1    -none- numeric
## size           3    -none- numeric
## iter           1    -none- numeric
## ifault         1    -none- numeric</code></pre>
<p>Note that the output is a list of vectors, with differing lengths. That’s because they contain different types of information:</p>
<ul>
<li>
<code>cluster</code> contains information about each point</li>
<li>
<code>centers</code>, <code>withinss</code>, and <code>size</code> contain information about each cluster</li>
<li>
<code>totss</code>, <code>tot.withinss</code>, <code>betweenss</code>, and <code>iter</code> contain information about the full clustering</li>
</ul>
</div>
<<<<<<< HEAD
</div>
</div>
<div id="visualise-clusters" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Visualise clusters<a class="anchor" aria-label="anchor" href="#visualise-clusters"><i class="fas fa-link"></i></a>
</h2>
<p>We can visualise the clusters that we calculated above.</p>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">tidyverse</span>
When we performed the clustering, the centers were calculated. These values give the (x, y) coordinates of the centroids.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy_clust</span> <span class="op">&lt;-</span> <span class="fu">tidy</span><span class="op">(</span><span class="va">kclust</span><span class="op">)</span> <span class="co"># get centroid coordinates</span>

<span class="va">tidy_clust</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   flipper_length_mm bill_length_mm  size withinss cluster
##               &lt;dbl&gt;          &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;fct&gt;  
## 1              197.           46.0    93    3932. 1      
## 2              187.           38.4   120    3494. 2      
## 3              217.           47.6   129    6658. 3</code></pre>
<div class="note">
<p>The initial centroids get randomly placed in the data. This, combined with the iterative nature of the process, means that the values that you will see are going to be slightly different from the values here. That’s normal!</p>
</div>
<p>Next, we want to visualise the which data points belong to which cluster. We can do that as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kclust</span> <span class="op">%&gt;%</span>                              <span class="co"># take clustering data</span>
  <span class="fu">augment</span><span class="op">(</span><span class="va">points</span><span class="op">)</span> <span class="op">%&gt;%</span>                   <span class="co"># combine with original data</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>,     <span class="co"># plot the original data</span>
             y <span class="op">=</span> <span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">.cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># colour by classification</span>
  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">tidy_clust</span>,
             size <span class="op">=</span> <span class="fl">7</span>, shape <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>     <span class="co"># add the cluster centers</span></code></pre></div>
<div class="inline-figure"><img src="clustering-practical-kmeans_files/figure-html/unnamed-chunk-11-1.png" width="672"></div>
</div>
<div class="panel">
<p><span class="panel-name">base R</span>
When we performed the clustering, the centers were calculated. These values give the (x, y) coordinates of the centroids.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kclust_r</span><span class="op">$</span><span class="va">centers</span>  <span class="co"># get centroid coordinates</span></code></pre></div>
<pre><code>##   penguins.flipper_length_mm penguins.bill_length_mm
## 1                   196.7312                45.95484
## 2                   186.9917                38.42750
## 3                   216.8837                47.56744</code></pre>
<div class="note">
<p>The initial centroids get randomly placed in the data. This, combined with the iterative nature of the process, means that the values that you will see are going to be slightly different from the values here. That’s normal!</p>
</div>
<p>Next, we want to visualise the which data points belong to which cluster. We can do that as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">points_r</span>,                <span class="co"># plot original data</span>
     col <span class="op">=</span> <span class="va">kclust_r</span><span class="op">$</span><span class="va">cluster</span>,  <span class="co"># colour by cluster</span>
     pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">kclust_r</span><span class="op">$</span><span class="va">centers</span>,      <span class="co"># add cluster centers</span>
       pch <span class="op">=</span> <span class="fl">4</span>,
       lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="clustering-practical-kmeans_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
</div>
</div>
</div>
<div id="optimising-cluster-number" class="section level2" number="2.8">
<h2>
<span class="header-section-number">2.8</span> Optimising cluster number<a class="anchor" aria-label="anchor" href="#optimising-cluster-number"><i class="fas fa-link"></i></a>
</h2>
<p>In the example we set the number of clusters to 3. This made sense, because the data already visually separated in roughly three groups - one for each species.</p>
<p>However, it might be that the cluster number to choose is a lot less obvious. In that case it would be helpful to explore clustering your data into a range of clusters.</p>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">tidyverse</span></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#tidy explore</span></code></pre></div>
</div>
<div class="panel">
<p><span class="panel-name">base R</span></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#baseR explore</span></code></pre></div>
</div>
=======
>>>>>>> b22398e385062f343f1bcb4b717c505a984a4490
</div>
<p>From the exploration we can see that three clusters are optimal in this scenario.</p>
</div>
<<<<<<< HEAD
<div id="exercise" class="section level2" number="2.9">
<h2>
=======
<div id="visualise-clusters" class="section level2" number="2.7">
<h2>
<span class="header-section-number">2.7</span> Visualise clusters<a class="anchor" aria-label="anchor" href="#visualise-clusters"><i class="fas fa-link"></i></a>
</h2>
<p>We can visualise the clusters that we calculated above.</p>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">tidyverse</span>
When we performed the clustering, the centers were calculated. These values give the (x, y) coordinates of the centroids.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidy_clust</span> <span class="op">&lt;-</span> <span class="fu">tidy</span><span class="op">(</span><span class="va">kclust</span><span class="op">)</span> <span class="co"># get centroid coordinates</span>

<span class="va">tidy_clust</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   flipper_length_mm bill_length_mm  size withinss cluster
##               &lt;dbl&gt;          &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;fct&gt;  
## 1              187.           38.4   120    3494. 1      
## 2              217.           47.6   129    6658. 2      
## 3              197.           46.0    93    3932. 3</code></pre>
<div class="note">
<p>The initial centroids get randomly placed in the data. This, combined with the iterative nature of the process, means that the values that you will see are going to be slightly different from the values here. That’s normal!</p>
</div>
<p>Next, we want to visualise the which data points belong to which cluster. We can do that as follows:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kclust</span> <span class="op">%&gt;%</span>                              <span class="co"># take clustering data</span>
  <span class="fu">augment</span><span class="op">(</span><span class="va">points</span><span class="op">)</span> <span class="op">%&gt;%</span>                   <span class="co"># combine with original data</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">flipper_length_mm</span>,     <span class="co"># plot the original data</span>
             y <span class="op">=</span> <span class="va">bill_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>colour <span class="op">=</span> <span class="va">.cluster</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># colour by classification</span>
  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">tidy_clust</span>,
             size <span class="op">=</span> <span class="fl">7</span>, shape <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span>     <span class="co"># add the cluster centers</span></code></pre></div>
<div class="inline-figure"><img src="clustering-practical-kmeans_files/figure-html/unnamed-chunk-11-1.png" width="672"></div>
</div>
<div class="panel">
<p><span class="panel-name">base R</span>
When we performed the clustering, the centers were calculated. These values give the (x, y) coordinates of the centroids.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kclust_r</span><span class="op">$</span><span class="va">centers</span>  <span class="co"># get centroid coordinates</span></code></pre></div>
<pre><code>##   penguins.flipper_length_mm penguins.bill_length_mm
## 1                   196.7312                45.95484
## 2                   186.9917                38.42750
## 3                   216.8837                47.56744</code></pre>
<div class="note">
<p>The initial centroids get randomly placed in the data. This, combined with the iterative nature of the process, means that the values that you will see are going to be slightly different from the values here. That’s normal!</p>
</div>
<p>Next, we want to visualise the which data points belong to which cluster. We can do that as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">points_r</span>,                <span class="co"># plot original data</span>
     col <span class="op">=</span> <span class="va">kclust_r</span><span class="op">$</span><span class="va">cluster</span>,  <span class="co"># colour by cluster</span>
     pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">kclust_r</span><span class="op">$</span><span class="va">centers</span>,      <span class="co"># add cluster centers</span>
       pch <span class="op">=</span> <span class="fl">4</span>,
       lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="clustering-practical-kmeans_files/figure-html/unnamed-chunk-13-1.png" width="672"></div>
</div>
</div>
</div>
<div id="optimising-cluster-number" class="section level2" number="2.8">
<h2>
<span class="header-section-number">2.8</span> Optimising cluster number<a class="anchor" aria-label="anchor" href="#optimising-cluster-number"><i class="fas fa-link"></i></a>
</h2>
<p>In the example we set the number of clusters to 3. This made sense, because the data already visually separated in roughly three groups - one for each species.</p>
<p>However, it might be that the cluster number to choose is a lot less obvious. In that case it would be helpful to explore clustering your data into a range of clusters.</p>
<div class="panelset">
<div class="panel">
<p><span class="panel-name">tidyverse</span></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#tidy explore</span></code></pre></div>
</div>
<div class="panel">
<p><span class="panel-name">base R</span></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#baseR explore</span></code></pre></div>
</div>
</div>
<p>From the exploration we can see that three clusters are optimal in this scenario.</p>
</div>
<div id="exercise" class="section level2" number="2.9">
<h2>
>>>>>>> b22398e385062f343f1bcb4b717c505a984a4490
<span class="header-section-number">2.9</span> Exercise<a class="anchor" aria-label="anchor" href="#exercise"><i class="fas fa-link"></i></a>
</h2>
<div class="exercise">
<p><span id="exr:unlabeled-div-1" class="exercise"><strong>Exercise 2.1  </strong></span>We can add exercises</p>
<details><summary>
Answer
</summary>
With answers
</details>
</div>
</div>
<div id="key-points" class="section level2" number="2.10">
<h2>
<span class="header-section-number">2.10</span> Key points<a class="anchor" aria-label="anchor" href="#key-points"><i class="fas fa-link"></i></a>
</h2>
<div class="keypoints">
<p>Adding key points</p>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="index.html"><span class="header-section-number">1</span> Overview</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#kmeans"><span class="header-section-number">2</span> K-means clustering</a></li>
<li><a class="nav-link" href="#objectives"><span class="header-section-number">2.1</span> Objectives</a></li>
<li><a class="nav-link" href="#libraries-and-functions"><span class="header-section-number">2.2</span> Libraries and functions</a></li>
<li><a class="nav-link" href="#workflow"><span class="header-section-number">2.3</span> Workflow</a></li>
<li><a class="nav-link" href="#data"><span class="header-section-number">2.4</span> Data</a></li>
<li><a class="nav-link" href="#visualise-the-data"><span class="header-section-number">2.5</span> Visualise the data</a></li>
<li><a class="nav-link" href="#clustering"><span class="header-section-number">2.6</span> Clustering</a></li>
<li><a class="nav-link" href="#visualise-clusters"><span class="header-section-number">2.7</span> Visualise clusters</a></li>
<li><a class="nav-link" href="#optimising-cluster-number"><span class="header-section-number">2.8</span> Optimising cluster number</a></li>
<li><a class="nav-link" href="#exercise"><span class="header-section-number">2.9</span> Exercise</a></li>
<li><a class="nav-link" href="#key-points"><span class="header-section-number">2.10</span> Key points</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

					</div>
				</div>

			</div>
		</div>
		<div class="campl-row campl-local-footer">
			<div class="campl-wrap clearfix">
				<div class="campl-column3 campl-footer-navigation">
					<div class="campl-content-container campl-navigation-list">
						<h3>Contact us</h3>
						 <div class="content">
						   <p>Bioinformatics Training Department of Genetics University of Cambridge Downing Street Cambridge CB2 3EH United Kingdom</p>
						   <h3>Contact:</h3> <a href="mailto:%20bioinfotraining@bio.cam.ac.uk">bioinfotraining@bio.cam.ac.uk</a>
						 </div>
					</div>
				</div>
				<div class="campl-column3 campl-footer-navigation">
					<div class="campl-content-container campl-navigation-list">
						<h3>Bioinformatics Training</h3>
						<ul class="campl-unstyled-list">
<li>
								<a href="https://bioinfotraining.bio.cam.ac.uk/undergraduate">Undergraduate training</a>
							</li>
							<li>
								<a href="https://bioinfotraining.bio.cam.ac.uk/postgraduate">Postgraduate training</a>
							</li>
						</ul>
</div>
				</div>
				<div class="campl-column3 campl-footer-navigation">
					<div class="campl-content-container campl-navigation-list">
						<h3>Postgraduate Courses by Theme</h3>
						<ul class="campl-unstyled-list">
<li>
								<a href="https://bioinfotraining.bio.cam.ac.uk/postgraduate/programming">Basic Skills and Programming</a>
							</li>
							<li>
								<a href="https://bioinfotraining.bio.cam.ac.uk/postgraduate/services">Databases and Services</a>
							</li>
							<li>
							  <a href="https://bioinfotraining.bio.cam.ac.uk/postgraduate/specialized">Specialised Topics</a>
							</li>
						</ul>
</div>
				</div>
				<div class="campl-column3 campl-footer-navigation last">
					<div class="campl-content-container campl-navigation-list">
						<h3>About Bioinformatics Training</h3>
						<ul class="campl-unstyled-list">
<li>
								<a href="https://bioinfotraining.bio.cam.ac.uk/about">About the Facility</a>
							</li>
							<li>
								<a href="https://bioinfotraining.bio.cam.ac.uk/about/findus">How to find us</a>
							</li>
							<li>
								<a href="https://bioinfotraining.bio.cam.ac.uk/about/visitors">Visiting Cambridge</a>
							</li>
							<li>
								<a href="https://bioinfotraining.bio.cam.ac.uk/privacy-and-cookie-policies">Privacy and Cookies policy</a>
							</li>
						</ul>
</div>
				</div>
			</div>
		</div>

<!--[if lte IE 8]>
</div>
<![endif]-->

	<script type="text/javascript" src="javascripts/libs/ios-orientationchange-fix.js"></script><script type="text/javascript" src="javascripts/libs/jquery-min.js"></script><script type="text/javascript" src="javascripts/libs/modernizr.js"></script><script type="text/javascript" src="javascripts/custom.js"></script>
</body>
</html>
