[{},{"path":"index.html","id":"overview","chapter":"1 Overview","heading":"1 Overview","text":"sessions intended enable perform additional data analysis techniques appropriately confidently using R Python.Ongoing formative assessment exercisesOngoing formative assessment exercisesNo formal assessmentNo formal assessmentNo mathematical derivationsNo mathematical derivationsNo pen paper calculationsNo pen paper calculationsThey “mindlessly use stats program” course!","code":""},{"path":"index.html","id":"core-aims","chapter":"1 Overview","heading":"1.1 Core aims","text":"know presented non-standard dataset e.g.Know deal non-normal dataKnow analyse count dataBe able deal random effects","code":""},{"path":"index.html","id":"core-topics","chapter":"1 Overview","heading":"1.2 Core topics","text":"Generalised linear models","code":""},{"path":"index.html","id":"index-datasets","chapter":"1 Overview","heading":"1.3 Datasets","text":"course uses various data sets. easiest way accessing creating R-project RStudio. download data folder right-clicking link Save …. Next unzip file copy working directory. data accessible via <working-directory-name>/data..panelset{--panel-tab-font-family: inherit;}","code":""},{},{"path":"principal-component-analysis-pca.html","id":"principal-component-analysis-pca","chapter":"2 Principal component analysis (PCA)","heading":"2 Principal component analysis (PCA)","text":"","code":""},{"path":"principal-component-analysis-pca.html","id":"objectives","chapter":"2 Principal component analysis (PCA)","heading":"2.1 Objectives","text":"QuestionsHow ……ObjectivesBe able …Use…","code":""},{"path":"principal-component-analysis-pca.html","id":"purpose-and-aim","chapter":"2 Principal component analysis (PCA)","heading":"2.2 Purpose and aim","text":"statistical technique reducing dimensionality data set. technique aims find new set variables describing data. new variables made weighted sum old variables. weighting chosen new variables can ranked terms importance first new variable chosen account much variation data possible. second new variable chosen account much remaining variation data possible, many new variables old variables.","code":""},{"path":"principal-component-analysis-pca.html","id":"libraries-and-functions","chapter":"2 Principal component analysis (PCA)","heading":"2.3 Libraries and functions","text":"tidyverse","code":""},{"path":"principal-component-analysis-pca.html","id":"data","chapter":"2 Principal component analysis (PCA)","heading":"2.4 Data","text":"First need data! liven things bit, ’ll using data palmerpenguins package. package whole bunch data penguins. ’s love?Penguins\npenguins data set comes palmerpenguins package (information, see GitHub page).","code":""},{"path":"principal-component-analysis-pca.html","id":"visualise-the-data","chapter":"2 Principal component analysis (PCA)","heading":"2.5 Visualise the data","text":"First , let’s look data. always good idea get sense data.tidyverse\nFirst, load inspect data:can see different kinds variables, factors numerical. Also, appear missing data data set, probably deal .Lastly, careful year column: recognised numerical column (contains numbers), view factor, since years categorical meaning.get better sense data plot numerical variables , see possible correlation . However, quite , might easier just create correlation matrix.tidyverse\nFirst, load corrr package, allows us plot correlation matrix using tidyverse syntax:get message (error) correlation method used pearson, default. also get message missing values treated, complete pairwise comparisons made.can see , example, strong positive correlation flipper_length_mm body_mass_g. variable combinations seem reasonably well-correlated, flipper_length_mm bill_length_mm (positive) flipper_length_mm bill_depth_mm (negative).many different variables appear correlated , just lots variables data don’t know look, can useful reduce number variables. can dimension reduction methods, Principal Component Analysis (PCA) one.Basically, PCA replaces original variables new ones: principal components. principal components consist parts original variables.compare smoothy consisting , let’s say, 80% orange, 10% strawberry 10% banana (kale).Similarly, new principal component consist 80% flipper_length_mm, 10% body_mass_g 10% bill_depth_mm (still kale).","code":"\n# attach the data\ndata(package = 'palmerpenguins')\n\n# inspect the data\npenguins## # A tibble: 344 × 8\n##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n##    <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n##  1 Adelie  Torgersen           39.1          18.7               181        3750\n##  2 Adelie  Torgersen           39.5          17.4               186        3800\n##  3 Adelie  Torgersen           40.3          18                 195        3250\n##  4 Adelie  Torgersen           NA            NA                  NA          NA\n##  5 Adelie  Torgersen           36.7          19.3               193        3450\n##  6 Adelie  Torgersen           39.3          20.6               190        3650\n##  7 Adelie  Torgersen           38.9          17.8               181        3625\n##  8 Adelie  Torgersen           39.2          19.6               195        4675\n##  9 Adelie  Torgersen           34.1          18.1               193        3475\n## 10 Adelie  Torgersen           42            20.2               190        4250\n## # … with 334 more rows, and 2 more variables: sex <fct>, year <int>\nlibrary(corrr)\n\npenguins_corr <- penguins %>%\n  select(where(is.numeric)) %>%  # select the numerical columns\n  correlate() %>%                # calculate the correlations\n  rearrange()                    # rearrange highly correlated## \n## Correlation method: 'pearson'\n## Missing treated using: 'pairwise.complete.obs'\n                                 # variables close together\n\npenguins_corr## # A tibble: 5 × 6\n##   term         flipper_length_… body_mass_g bill_length_mm    year bill_depth_mm\n##   <chr>                   <dbl>       <dbl>          <dbl>   <dbl>         <dbl>\n## 1 flipper_len…           NA          0.871          0.656   0.170        -0.584 \n## 2 body_mass_g             0.871     NA              0.595   0.0422       -0.472 \n## 3 bill_length…            0.656      0.595         NA       0.0545       -0.235 \n## 4 year                    0.170      0.0422         0.0545 NA            -0.0604\n## 5 bill_depth_…           -0.584     -0.472         -0.235  -0.0604       NA"},{"path":"principal-component-analysis-pca.html","id":"performing-the-pca","chapter":"2 Principal component analysis (PCA)","heading":"2.6 Performing the PCA","text":"tidyverse\nperform PCA, ’ll use recipe() pre-processing steps:remove NA valuescentre predictorsscale predictors","code":"\npenguin_recipe <-\n  recipe(~., data = penguins) %>% \n  update_role(species, island, sex, year, new_role = \"id\") %>% \n  step_naomit(all_predictors()) %>% \n  step_normalize(all_predictors()) %>%\n  step_pca(all_predictors(), id = \"pca\") %>% \n  prep()\n\npenguin_pca <- \n  penguin_recipe %>% \n  tidy(id = \"pca\") \n\npenguin_pca## # A tibble: 16 × 4\n##    terms                value component id   \n##    <chr>                <dbl> <chr>     <chr>\n##  1 bill_length_mm     0.455   PC1       pca  \n##  2 bill_depth_mm     -0.400   PC1       pca  \n##  3 flipper_length_mm  0.576   PC1       pca  \n##  4 body_mass_g        0.548   PC1       pca  \n##  5 bill_length_mm    -0.597   PC2       pca  \n##  6 bill_depth_mm     -0.798   PC2       pca  \n##  7 flipper_length_mm -0.00228 PC2       pca  \n##  8 body_mass_g       -0.0844  PC2       pca  \n##  9 bill_length_mm    -0.644   PC3       pca  \n## 10 bill_depth_mm      0.418   PC3       pca  \n## 11 flipper_length_mm  0.232   PC3       pca  \n## 12 body_mass_g        0.597   PC3       pca  \n## 13 bill_length_mm     0.146   PC4       pca  \n## 14 bill_depth_mm     -0.168   PC4       pca  \n## 15 flipper_length_mm -0.784   PC4       pca  \n## 16 body_mass_g        0.580   PC4       pca"},{"path":"principal-component-analysis-pca.html","id":"visualising-pcs","chapter":"2 Principal component analysis (PCA)","heading":"2.7 Visualising PCs","text":"Now ’ve performed PCA, can bit closer look. useful way looking much PCs (principal components) contributing amount variance explained create screeplot. Basically, plots percentage explained variance PC.tidyverse\ncan extract relevant data directly penguin_recipe object:definition, first principal component (PC1) always explain largest amount variation. case, PC1 explains almost 70% variance!’s pretty good going, since means instead look four variables, look just one still capture 70% variance data. number variables data set manageable, probably wouldn’t . However, data set hundreds variables, seeing can described well using PCs useful thing .","code":"\npenguin_recipe %>% \n  tidy(id = \"pca\", type = \"variance\") %>% \n  filter(terms == \"percent variance\") %>% \n  ggplot(aes(x = component, y = value)) + \n  geom_col() + \n  xlim(c(0, 5)) +\n  ylab(\"% of total variance\")"},{"path":"principal-component-analysis-pca.html","id":"loadings","chapter":"2 Principal component analysis (PCA)","heading":"2.8 Loadings","text":"Let’s think back smoothy metaphor. Remember smoothy made various fruits - just like PCs made parts original variables.Let’s, sake illustrating , assume following PC1:PC something called eigenvector, simplest terms line certain direction length.want calculate length eigenvector PC1, can employ Pythagoras (well, directly, just legacy). gives:\\(eigenvector \\, PC1 = \\sqrt{4^2 + 1^2} = 4.12\\)loading scores PC1 “parts” scaled length, .e.:can values plot loadings original variables. example, plotted PC1 PC2, wanted see much original variables contribute principal component, following:tidyverse\nloadings encoded value column pca object (penguin_pca). plot , need data “wide” format:can see four terms (original variables) four PCs. makes sense, maximum number principal components exceed number original variables.need bit data gymnastics, defining arrow style (vectors represented using arrows), plotting PCs, plotting loadings.Arrow:plot PC1 vs PC2, need extract relevant data. PCA-related data stored penguin_recipe object. Since people developed tidymodels quite fond verbs (’m really adjective kind--guy …) invented bake() function.logic : follow recipe() bake() . Yes, know.Anyways, use get data penguin_recipe, telling function shouldn’t expect new data (function also used model testing, data split training test data set).spits original table, PC values instead original variables. can use information plot PCs, focussing PC1 vs PC2:Lastly (finally), take plot add loading data top :Slightly annoyingly, can cause overlap labels. Also, many different variables , ’ll become rather tricky interpret web vectors.things look pretty OK still. One thing immediately obvious data Gentoo penguins PCs quite distinct Adelie Chinstrap penguins.PC-perspective, flipper_length_mm body_mass_g variables make PC1, since vectors almost horizontal.contrast, bill_length_mm bill_depth_mm contribute lot PC2. also contribute positively (bill_length_mm) negatively (bill_depth_mm) PC1.mentioned, vectors can become bit messy terms visualisation. can useful represent loadings differently. Note , point, ’m aware method allows reasonably straightforward anything R’s tidyverse.tidyverse\nfollowing work, need load tidytext libary. can follows:gives us loadings variable, facetted principal component. reason ’re plotting absolute values, can compare positive negative contributions. PC absolute loadings sorted descending order. distinguish positive negative loadings use colours.important keep amount variance explained PC mind. example, PC3 explains around 9% variance. although bill length body mass contribute substantially PC3, contribution PC3 remains small.","code":"\n# get pca loadings into wider format\npca_wider <- penguin_pca %>% \n  pivot_wider(names_from = component, id_cols = terms)\n\npca_wider## # A tibble: 4 × 5\n##   terms                PC1      PC2    PC3    PC4\n##   <chr>              <dbl>    <dbl>  <dbl>  <dbl>\n## 1 bill_length_mm     0.455 -0.597   -0.644  0.146\n## 2 bill_depth_mm     -0.400 -0.798    0.418 -0.168\n## 3 flipper_length_mm  0.576 -0.00228  0.232 -0.784\n## 4 body_mass_g        0.548 -0.0844   0.597  0.580\n# define arrow style\narrow_style <- arrow(length = unit(2, \"mm\"),\n                     type = \"closed\")\nbake(penguin_recipe, new_data = NULL)## # A tibble: 342 × 8\n##    species island    sex     year    PC1      PC2     PC3     PC4\n##    <fct>   <fct>     <fct>  <int>  <dbl>    <dbl>   <dbl>   <dbl>\n##  1 Adelie  Torgersen male    2007 -1.84  -0.0476   0.232   0.523 \n##  2 Adelie  Torgersen female  2007 -1.30   0.428    0.0295  0.402 \n##  3 Adelie  Torgersen female  2007 -1.37   0.154   -0.198  -0.527 \n##  4 Adelie  Torgersen female  2007 -1.88   0.00205  0.618  -0.478 \n##  5 Adelie  Torgersen male    2007 -1.91  -0.828    0.686  -0.207 \n##  6 Adelie  Torgersen female  2007 -1.76   0.351   -0.0276  0.504 \n##  7 Adelie  Torgersen male    2007 -0.809 -0.522    1.33    0.338 \n##  8 Adelie  Torgersen <NA>    2007 -1.83   0.769    0.689  -0.427 \n##  9 Adelie  Torgersen <NA>    2007 -1.19  -1.02     0.729   0.333 \n## 10 Adelie  Torgersen <NA>    2007 -1.73   0.787   -0.205   0.0205\n## # … with 332 more rows\npca_plot <-\n  bake(penguin_recipe, new_data = NULL) %>%\n  ggplot(aes(PC1, PC2)) +\n  geom_point(aes(colour = species), # colour the data\n             alpha = 0.8,           # add transparency\n             size = 2)              # make the data points bigger\n\npca_plot\npca_plot +\n  # define the vector\n  geom_segment(data = pca_wider,\n               aes(xend = PC1, yend = PC2), \n               x = 0, \n               y = 0, \n               arrow = arrow_style) + \n  # add the text labels\n  geom_text(data = pca_wider,\n            aes(x = PC1, y = PC2, label = terms), \n            hjust = 0, \n            vjust = 1,\n            size = 5) \nlibrary(tidytext)\npenguin_pca %>%\n  mutate(terms = reorder_within(terms, \n                                abs(value), \n                                component)) %>%\n  ggplot(aes(abs(value), terms, fill = value > 0)) +\n  geom_col() +\n  facet_wrap(~ component, scales = \"free_y\") +\n  tidytext::scale_y_reordered() +\n  labs(\n    x = \"Absolute value of contribution\",\n    y = NULL, fill = \"Positive?\"\n  ) "},{"path":"principal-component-analysis-pca.html","id":"exercise","chapter":"2 Principal component analysis (PCA)","heading":"2.9 Exercise","text":"Exercise 2.1  Exercisetidyversequestiontidyverseanswer","code":""},{"path":"principal-component-analysis-pca.html","id":"key-points","chapter":"2 Principal component analysis (PCA)","heading":"2.10 Key points","text":"Point 1Point 2Point 3","code":""}]
